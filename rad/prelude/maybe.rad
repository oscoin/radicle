(def map-maybe
  (fn [f]
    (fn [m]
      (maybe m :Nothing (fn [x] [:Just (f x)])))))

(document 'map-maybe
          '(("f" function))
          "Functor mapping for Maybe values.")

(should-be "map-maybe maps :Nothing"
           ((map-maybe (fn [x] (+ x 1))) :Nothing)
           :Nothing)

(should-be "map-maybe maps :Just"
           ((map-maybe (fn [x] (+ x 1))) [:Just 0])
           [:Just 1])
